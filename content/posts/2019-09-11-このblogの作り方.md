---
layout: blog
title: このblogの作り方
date: 2019-09-11T12:16:09.332Z
rating: 0
---
blogを作成した記念に、このblogをどうやって作成したかを残しておきます。

# 使用する技術・サービス

* GitHub
* Netlify/Netlify CMS
* Hugo

# 手順の概要

1. 必要なソフトのインストール
2. GitHubにレポジトリを作成
3. Hugoでサイトの雛形を作成
4. テーマを選定・設定
5. Netlify CMSの設定
6. 管理者用の設定
7. Netlifyで公開
8. 独自ドメインでの公開

# 必要なソフトのインストール

このblogでは静的サイトジェネレータとしてHugoを使用しています。
ローカルマシンでHugoが動作する環境を整えます。

```
brew install hugo
```

なり、

```
sudo yum install hugo
```

など。詳細は以下のサイトを参照してください。

<https://gohugo.io/getting-started/installing>

# GitHubにレポジトリを作成

Netlifyでサイトを公開する元としてよく使われるのがGitHubのレポジトリです。ここではまず空のレポジトリを作成します。

GitHubのサイトでレポジトリを作成して `git clone` するか、直接ローカルで`git init`するなどして、ローカルでレポジトリを編集できるようにします。

# Hugoでサイトの雛形を作成

レポジトリ直下で、以下のコマンドを実行してサイトの雛形を作成します。

```
hugo new site . --force
```

<https://gohugo.io/getting-started/quick-start/#step-2-create-a-new-site> によると、レポジトリを作成する前に`hugo new site フォルダ名`で雛形を作成していますが、私は上記の順序で行いました。

# テーマの選定・設定
次はテーマを選定・設定していきます。
<https://themes.gohugo.io/>を見て、好みのテーマを選びます。
今回は、[Mainroad](https://themes.gohugo.io/mainroad/)を選びました。

テーマを選んだら、レポジトリ直下から見て`themes/mainroad`フォルダにGitのサブモジュールとして追加します。

```
git submodule add https://github.com/vimux/mainroad themes/mainroad
```

また、Mainroadテーマを使用する設定を`config.toml｀ファイルに記述します。

```
vim config.toml

theme = "mainroad"
```

# Netlify CMSの設定
次に、Netlify CMSの設定を行います。
<https://www.netlifycms.org/docs/add-to-your-site/>を参考に、
`static/admin/index.html, static/admin/config.yml` を追加していきます。

実際に追加したファイルは以下の通りです。

```html
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Content Manager</title>
</head>
<body>
  <!-- Include the script that builds the page and powers Netlify CMS -->
  <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
</body>
</html>
```

```yaml
backend:
  name: github
  repo: oldgeese/blog-oldgeese-net
publish_mode: editorial_workflow
media_folder: "static/images/uploads" # Media files will be stored in the repo under static/images/uploads
public_folder: "/images/uploads" # The src attribute for uploaded media will begin with /images/uploads
collections:
  - name: "blog" # Used in routes, e.g., /admin/collections/blog
    label: "Blog" # Used in the UI
    folder: "content/posts" # The path to the folder where the documents are stored
    create: true # Allow users to create new documents in this collection
    slug: "{{year}}-{{month}}-{{day}}-{{slug}}" # Filename template, e.g., YYYY-MM-DD-title.md
    fields: # The fields for each document, usually in front matter
      - {label: "Layout", name: "layout", widget: "hidden", default: "blog"}
      - {label: "Title", name: "title", widget: "string"}
      - {label: "Publish Date", name: "date", widget: "datetime"}
      - {label: "Featured Image", name: "thumbnail", widget: "image", required: false}
      - {label: "Rating (scale of 1-5)", name: "rating", widget: "number"}
      - {label: "Body", name: "body", widget: "markdown"}
```


